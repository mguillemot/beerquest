<?xml version="1.0"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="520" height="320">
    <mx:Style>
        .end-goal {
            fontFamily: Kro;
            fontSize: 30;
            color: white;
        }

        .failed-end-goal {
            fontFamily: Kro;
            fontSize: 30;
            color: red;
        }

        .success-end-goal {
            fontFamily: Kro;
            fontSize: 30;
            color: #ffd700;
        }

        .end-title {
            fontFamily: Kro;
            fontSize: 48;
            color: white;
        }

        .success-end-title {
            fontFamily: Kro;
            fontSize: 48;
            color: #ffd700;
        }

        .failed-end-title {
            fontFamily: Kro;
            fontSize: 48;
            color: red;
        }

        .end-explaination {
            fontFamily: Kro;
            fontSize: 16;
            color: white;
        }

        .success-end-explaination {
            fontFamily: Kro;
            fontSize: 16;
            color: #ffd700;
        }

        .failed-end-explaination {
            fontFamily: Kro;
            fontSize: 16;
            color: red;
        }
    </mx:Style>
    <mx:Script><![CDATA[
        import com.beerquest.I18n;

        import mx.controls.Alert;

        public function setResult(mode:String, score:int, scoreGoal:int, personalHigh:Boolean, barHigh:Boolean):void {
            _mode = mode;
            _score = score;
            if (mode == "solo") {
                _personalHigh = personalHigh;
                _barHigh = barHigh;
                if (_personalHigh || _barHigh) {
                    soloHigh.visible = true;
                } else {
                    soloNoHigh.visible = true;
                }
            } else {
                _scoreGoal = scoreGoal;
                if (score >= scoreGoal) {
                    vsSuccess.visible = true;
                } else {
                    vsFailure.visible = true;
                }
            }
        }

        private function onBoast(e:MouseEvent):void {
            if (ExternalInterface.available) {
                ExternalInterface.call("soloBoast", _score);
            } else {
                Alert.show("Error (1)");
            }
        }

        private function onPlayAgain(e:MouseEvent):void {
            if (ExternalInterface.available) {
                ExternalInterface.call("soloPlayAgain");
            } else {
                Alert.show("Error (2)");
            }
        }

        private function onVsBoastVictory(e:MouseEvent):void {
            if (ExternalInterface.available) {
                ExternalInterface.call("vsBoastVictory", _score, _scoreGoal);
            } else {
                Alert.show("Error (3)");
            }
        }

        private function onVsBoastDefeat(e:MouseEvent):void {
            if (ExternalInterface.available) {
                ExternalInterface.call("vsBoastDefeat", _score, _scoreGoal);
            } else {
                Alert.show("Error (4)");
            }
        }

        private function onVsProvoke(e:MouseEvent):void {
            if (ExternalInterface.available) {
                ExternalInterface.call("vsProvoke", _scoreGoal);
            } else {
                Alert.show("Error (5)");
            }
        }

        private function onVsPlayAgain(e:MouseEvent):void {
            if (ExternalInterface.available) {
                ExternalInterface.call("vsPlayAgain");
            } else {
                Alert.show("Error (6)");
            }
        }

        [Bindable]
        private var _mode:String;

        [Bindable]
        private var _score:int;

        [Bindable]
        private var _scoreGoal:int;

        [Bindable]
        private var _personalHigh:Boolean;

        [Bindable]
        private var _barHigh:Boolean;
        ]]></mx:Script>
    <mx:Image source="@Embed(source='../../../assets/image/rideau.png')"/>

    <mx:VBox id="soloNoHigh" width="100%" horizontalAlign="center" visible="false">
        <mx:Spacer height="10"/>
        <mx:Label text="{I18n.t('end.game-over')}" styleName="end-title">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:HBox horizontalGap="3">
            <mx:Label text="{I18n.t('end.score')}" styleName="end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
            <mx:Image source="@Embed(source='../../../assets/image/collected-beer.png')"/>
            <mx:Label text="{_score}" styleName="end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
        </mx:HBox>
        <mx:Label text="{I18n.t('end.solo.bad-score.1')}" styleName="end-explaination">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:Label text="{I18n.t('end.solo.bad-score.2')}" styleName="end-explaination">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:HBox horizontalGap="20">
            <mx:Button label="{I18n.t('end.boast-button')}" width="150" height="80" click="onBoast(event)"/>
            <mx:Button label="{I18n.t('end.play-again-button')}" width="150" height="80" click="onPlayAgain(event)"/>
        </mx:HBox>
    </mx:VBox>

    <mx:VBox id="soloHigh" width="100%" horizontalAlign="center" visible="false">
        <mx:Spacer height="10"/>
        <mx:Label text="{I18n.t('end.congratulations')}" styleName="success-end-title">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:HBox horizontalGap="3">
            <mx:Label text="{I18n.t('end.score')}" styleName="success-end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
            <mx:Image source="@Embed(source='../../../assets/image/collected-beer.png')"/>
            <mx:Label text="{_score}" styleName="end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
        </mx:HBox>
        <mx:Label text="{I18n.t('end.personal-record')}" styleName="success-end-explaination" visible="{_personalHigh}">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:Label text="{I18n.t('end.bar-record')}" styleName="success-end-explaination" visible="{_barHigh}">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:HBox horizontalGap="20">
            <mx:Button label="{I18n.t('end.play-again-button')}" width="150" height="80" click="onPlayAgain(event)"/>
            <mx:Button label="{I18n.t('end.boast-button')}" width="150" height="80" click="onBoast(event)"/>
        </mx:HBox>
    </mx:VBox>

    <mx:VBox id="vsSuccess" width="100%" horizontalAlign="center" visible="false">
        <mx:Spacer height="10"/>
        <mx:HBox horizontalGap="3">
            <mx:Label text="{I18n.t('start.goal')} =" styleName="end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
            <mx:Image source="@Embed(source='../../../assets/image/collected-beer.png')"/>
            <mx:Label text="{_scoreGoal}" styleName="end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
        </mx:HBox>
        <mx:Label text="{I18n.t('end.congratulations')}" styleName="end-title">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:Label text="{I18n.t('end.challenge-success-explaination.1')}" styleName="end-explaination">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:Label text="{I18n.t('end.challenge-success-explaination.2')}" styleName="end-explaination">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:HBox horizontalGap="20">
            <mx:Button label="{I18n.t('end.boast-button')}" width="150" height="80" click="onVsBoastVictory(event)"/>
            <mx:Button label="{I18n.t('end.provoke-button')}" width="150" height="80" click="onVsProvoke(event)"/>
        </mx:HBox>
    </mx:VBox>

    <mx:VBox id="vsFailure" width="100%" horizontalAlign="center" visible="false">
        <mx:Spacer height="10"/>
        <mx:HBox horizontalGap="3">
            <mx:Label text="{I18n.t('start.goal')} &lt;" styleName="failed-end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
            <mx:Image source="@Embed(source='../../../assets/image/collected-beer.png')"/>
            <mx:Label text="{_scoreGoal}" styleName="failed-end-goal">
                <mx:filters>
                    <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
                </mx:filters>
            </mx:Label>
        </mx:HBox>
        <mx:Label text="{I18n.t('end.you-loose')}" styleName="end-title">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:Label text="{I18n.t('end.loose-explaination.1')}" styleName="end-explaination">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:Label text="{I18n.t('end.loose-explaination.2')}" styleName="end-explaination">
            <mx:filters>
                <mx:DropShadowFilter distance="2" angle="45" blurX="0" blurY="0" alpha="1" color="0x111111"/>
            </mx:filters>
        </mx:Label>
        <mx:HBox horizontalGap="20">
            <mx:Button label="{I18n.t('end.start-another-challenge-button')}" width="150" height="80" click="onVsPlayAgain(event)"/>
            <mx:Button label="{I18n.t('end.wall-of-shame-button')}" width="150" height="80" click="onVsBoastDefeat(event)"/>
        </mx:HBox>
    </mx:VBox>
</mx:Canvas>
